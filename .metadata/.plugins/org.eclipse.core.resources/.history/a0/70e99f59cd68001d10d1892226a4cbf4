package com.keilacouto.provanivel2;

import java.math.BigDecimal;
import java.util.Date;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

import com.keilacouto.provanivel2.enums.EnumStatusPedido;
import com.keilacouto.provanivel2.enums.EnumStatusProduto;
import com.keilacouto.provanivel2.enums.EnumTipoProduto;
import com.keilacouto.provanivel2.model.ItemPedido;
import com.keilacouto.provanivel2.model.Pedido;
import com.keilacouto.provanivel2.model.Produto;
import com.keilacouto.provanivel2.repositories.ItemPedidoRepository;
import com.keilacouto.provanivel2.repositories.PedidoRepository;
import com.keilacouto.provanivel2.repositories.ProdutoRepository;

@SpringBootApplication
public class VendasApplication {
	
	public CommandLineRunner init(
			@Autowired PedidoRepository pedidos,
			@Autowired ProdutoRepository produtos,
			@Autowired ItemPedidoRepository itensPedido) {
		
		return args -> {
			
			Produto pd = new Produto();
			pd.setDescricao("Produto 1");
			pd.setTipo(EnumTipoProduto.SERVICO);
			pd.setStatus(EnumStatusProduto.ATIVO);
			pd.setValorUnitario(new BigDecimal(100));
			
			produtos.save(pd);
			
			Pedido p = new Pedido();
			p.setDataPedido(new Date());
			p.setValorTotalBruto(new BigDecimal(100));
			p.setValorTotalLiquido(new BigDecimal(100));
			p.setStatus(EnumStatusPedido.ABERTO);
			
			pedidos.save(p);
			
			ItemPedido i = new ItemPedido();
			i.setPedido(p);
			i.setProduto(pd);
			i.setQuantidade(1);
			i.setPercentualDesconto(new BigDecimal(10));
			i.setValorBruto(new BigDecimal(100));
			i.setValorLiquido(new BigDecimal(100));
			
			itensPedido.save(i);
		};
	}
	
	@Autowired
	PedidoRepository repository;

	public static void main(String[] args) {
		SpringApplication.run(VendasApplication.class, args);
	}

}
